{{- if .Values.olakeUI.enabled }}
apiVersion: v1
kind: ConfigMap
metadata:
  name: olake-ui-config
  namespace: {{ .Values.namespace.name }}
  annotations: {}
  labels:
    app.kubernetes.io/name: olake-ui
    app.kubernetes.io/instance: {{ .Release.Name }}
    app.kubernetes.io/component: ui
    {{- include "olake.labels" . | nindent 4 }}
data:
  # Beego App Configuration File
  app.conf: |
    # OLake Configuration (Backend + Frontend combined)
    appname = olake-server
    httpport = 8080
    runmode = dev
    autorender = false
    copyrequestbody = true
    EnableDocs = true
    postgresdb = postgres://{{ tpl .Values.olakeUI.config.database.user . }}:{{ tpl .Values.olakeUI.config.database.password . }}@{{ tpl .Values.olakeUI.config.database.host . }}:{{ tpl .Values.olakeUI.config.database.port . }}/postgres?sslmode=disable
    logsdir = ./logger/logs
    sessionon = true
    
    # Deployment Mode
    DEPLOYMENT_MODE = kubernetes
    
    # Database Configuration
    DB_HOST = {{ tpl .Values.olakeUI.config.database.host . }}
    DB_PORT = {{ tpl .Values.olakeUI.config.database.port . }}
    DB_USER = {{ tpl .Values.olakeUI.config.database.user . }}
    DB_PASSWORD = {{ tpl .Values.olakeUI.config.database.password . }}
    DB_NAME = {{ tpl .Values.olakeUI.config.database.name . }}
    DB_SSLMODE = disable
    
    # Temporal Configuration
    TEMPORAL_ADDRESS = {{ tpl .Values.olakeUI.config.temporal.host . }}:{{ tpl .Values.olakeUI.config.temporal.port . }}
    
    # Logging
    LOG_LEVEL = info
    
    # Frontend Configuration
    FRONTEND_PORT = 8000
    API_BASE_URL = http://localhost:8080

    # Environment Variables for the application
    PERSISTENT_DIR = /tmp/olake-config

    # PostgreSQL connection string for compatibility
    POSTGRES_DB: "postgres://temporal:temporal@{{ tpl .Values.olakeUI.config.database.host . }}:{{ tpl .Values.olakeUI.config.database.port . }}/postgres?sslmode=disable"
{{- end }}