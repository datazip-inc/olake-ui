# -- Provide a name in place of olake for `app:` labels
nameOverride: ""

# -- Provide a name to substitute for the full names of resources
fullnameOverride: ""

# -- Global configuration that applies to all components
global:
  # -- Global storage class for all persistent volumes
  # Set to "" to disable dynamic provisioning
  # Examples: gp2, standard, managed
  storageClass: ""
  
  # -- Job scheduling configuration for pods created by olake-worker
  # Controls how sync, discover, and test job pods are scheduled on the cluster
  job:
    sync:
      nodeSelector: {}
      tolerations: []
      antiAffinity:
        enabled: true
        strategy: "hard"
        topologyKey: "kubernetes.io/hostname"
    
    discover:
      nodeSelector: {}
      tolerations: []
      antiAffinity:
        enabled: false
        strategy: "soft"
        topologyKey: "kubernetes.io/hostname"
    
    test:
      nodeSelector: {}
      tolerations: []
      antiAffinity:
        enabled: false
        strategy: "soft"
        topologyKey: "kubernetes.io/hostname"

# OLake UI - Main application
olakeUI:
  # -- Number of OLake UI replicas
  # For production, consider 2+ replicas for high availability
  replicaCount: 1
  
  # -- OLake UI image configuration
  image:
    repository: olakego/olake-ui
    tag: latest
    pullPolicy: Always
  
  # -- Pod scheduling constraints
  nodeSelector: {}
  
  # -- Tolerations for pod assignment
  tolerations: []
  
  # -- Affinity settings for pod assignment
  affinity: {}
  
  # -- Additional pod annotations
  podAnnotations: {}
  
  # -- Additional pod labels
  podLabels: {}
  
  # -- OLake UI service configuration
  # For external access, change type to NodePort or LoadBalancer  
  service:
    # -- Service type (ClusterIP for internal, NodePort/LoadBalancer for external access)
    type: ClusterIP
    annotations: {}
  
  # -- OLake UI resource requirements (optional overrides)
  # Defaults: requests: memory=512Mi, cpu=500m (no limits by default)
  # Example customizations:
  #   resources:
  #     requests:
  #       memory: "1Gi"
  #       cpu: "750m"
  #     limits:
  #       memory: "2Gi"
  #       cpu: "1500m"
  resources: {}
  
  # -- Ingress configuration for external access
  ingress:
    # -- Enable ingress
    enabled: false
    
    # -- Ingress class name
    # Examples: nginx, traefik, alb
    className: ""
    
    # -- Ingress annotations
    # Add custom annotations for your ingress controller here.
    # Examples:
    #   nginx.ingress.kubernetes.io/rewrite-target: /
    #   kubernetes.io/ingress.class: nginx
    #   kubernetes.io/tls-acme: "true"
    #   cert-manager.io/cluster-issuer: "letsencrypt-prod"
    annotations: {}
    
    # -- Ingress hosts configuration
    # List of host definitions for ingress. Each host can have multiple paths.
    # Examples:
    #   hosts:
    #     - host: olake.local
    #       paths:
    #         - path: /
    #           pathType: Prefix
    #     - host: olake.example.com
    #       paths:
    #         - path: /
    #           pathType: Prefix
    hosts: []
    
    # -- TLS configuration
    # Examples:
    #   tls:
    #     - secretName: olake-tls
    #       hosts:
    #         - olake.example.com
    tls: []
  
  # -- Initialization job configuration
  initJob:
    # -- Admin user credentials for initial setup
    adminUser:
      # -- Admin username
      username: "admin"
      
      # -- Admin password (change this in production!)
      password: "password"
      
      # -- Admin email address
      email: "admin@example.com"

# OLake K8s Worker - Executes data pipeline tasks as Kubernetes pods
olakeWorker:
  # -- OLake Worker image configuration
  image:
    repository: olakego/olake-worker-k8s
    tag: latest
    pullPolicy: Always
  
  # -- Pod scheduling constraints
  nodeSelector: {}
  
  # -- Tolerations for pod assignment
  tolerations: []
  
  # -- Affinity settings for pod assignment
  affinity: {}
  
  # -- Additional pod annotations
  podAnnotations: {}
  
  # -- Additional pod labels
  podLabels: {}
  
  # -- OLake Worker resource requirements (optional overrides)
  # Defaults: requests: memory=256Mi, cpu=250m (no limits by default)
  # Example customizations:
  #   resources:
  #     requests:
  #       memory: "512Mi"
  #       cpu: "500m"
  #     limits:
  #       memory: "1Gi"
  #       cpu: "1000m"
  resources: {}
  
  # -- Service Account configuration for Kubernetes API access
  serviceAccount:
    # -- Create service account
    create: true
    
    # -- Service account name
    # If not set and create is true, a name is generated using the fullname template
    name: ""
    
    # -- Service account annotations
    annotations: {}
  
  # -- OLake Worker application configuration
  config:
    worker:
      # -- Maximum concurrent activities(https://docs.temporal.io/activities) per worker
      # Increase for higher throughput, decrease for resource constraints
      maxConcurrentActivities: 15
      
      # -- Maximum concurrent workflows(https://docs.temporal.io/workflows) per worker
      maxConcurrentWorkflows: 10
    
    # -- Timeout configuration for different operation types
    timeouts:
      # -- Workflow execution timeouts
      workflow:
        discover: 3h
        test: 3h
        sync: 720h

      # -- Activity execution timeouts
      activity:
        discover: 2h
        test: 2h
        sync: 700h
    
    # -- Logging configuration
    logging:
      level: info
      format: console

# Storage configuration for shared data exchange between pods
nfsServer:
  # -- Enable NFS server deployment with dynamic provisioning
  # IMPORTANT: NFS components are created once and persist across helm operations.
  # They will NOT be deleted on 'helm uninstall' or modified on 'helm upgrade'.
  # This ensures data persistence but requires manual management for updates.
  enabled: true

  # -- External storage configuration (used when enabled: false)
  # When disabled, you must provide an existing ReadWriteMany (RWX) PersistentVolumeClaim
  # 
  # CLOUD PROVIDER GUIDES FOR RWX STORAGE:
  # 
  # AWS EFS: Use the Amazon EFS CSI driver with 'efs.csi.aws.com' provisioner
  # See: https://github.com/kubernetes-sigs/aws-efs-csi-driver
  # 
  # Azure Files: Use 'azurefile' StorageClass with 'kubernetes.io/azure-file' provisioner  
  # See: https://docs.microsoft.com/en-us/azure/aks/azure-files-csi
  # 
  # GCP Filestore: Use Google Cloud Filestore CSI driver with 'filestore.csi.storage.gke.io' provisioner
  # See: https://cloud.google.com/filestore/docs/csi-driver
  external:
    # -- The name of the PersistentVolumeClaim for the external RWX storage
    # Example: "efs-pvc" or "azure-files-pvc" or "gcp-filestore-pvc"
    name: ""
  
  
  # -- Pod scheduling constraints
  nodeSelector: {}
  
  # -- Tolerations for pod assignment
  tolerations: []
  
  # -- Affinity settings for pod assignment
  affinity: {}
  
  # -- Additional pod annotations
  podAnnotations: {}
  
  # -- Additional pod labels
  podLabels: {}
  
  # -- Persistence configuration for NFS server backing storage
  persistence:
    # -- Size of backing storage for NFS server
    size: 20Gi
  
  # -- StorageClass configuration for dynamic provisioning
  storageClass:
    # -- Name of the StorageClass created by NFS server
    name: "nfs-server"

# Temporal configuration for workflow orchestration
temporal:
  # -- Temporal server configuration
  server:
    
    # -- Temporal server image configuration
    image:
      repository: temporalio/auto-setup
      tag: "1.22.3"
      pullPolicy: Always
    
    # -- Pod scheduling constraints
    nodeSelector: {}
    
    # -- Tolerations for pod assignment
    tolerations: []
    
    # -- Affinity settings for pod assignment
    affinity: {}
    
    # -- Additional pod annotations
    podAnnotations: {}
    
    # -- Additional pod labels
    podLabels: {}
    
    # -- Temporal server resource requirements (optional overrides)
    # Defaults: requests: memory=512Mi, cpu=500m (no limits by default)
    # Example customizations:
    #   resources:
    #     requests:
    #       memory: "1Gi"
    #       cpu: "750m"
    #     limits:
    #       memory: "2Gi"
    #       cpu: "1500m"
    resources: {}
  
  # -- Temporal Web UI configuration (disabled by default)
  ui:
    # -- Enable Temporal Web UI
    enabled: false

# PostgreSQL is used as the backend database for Temporal and OLake
postgresql:
  # -- PostgreSQL image configuration
  image:
    repository: postgres
    tag: "14-alpine"
    pullPolicy: Always
  
  # -- Authentication configuration
  auth:
    # -- PostgreSQL super user name
    postgresUser: "temporal"
    
    # -- PostgreSQL super user password
    # In production, consider using existingSecret
    postgresPassword: "temporal"
    
    # -- PostgreSQL application database
    database: "temporal"
    
    # -- Name of existing secret containing PostgreSQL credentials
    # Keys: postgres-password, password, username
    existingSecret: ""
    
    # -- Key in existing secret containing PostgreSQL super user password
    secretKeys:
      adminPasswordKey: postgres-password
      userPasswordKey: password
      usernameKey: username
  
  # -- Pod scheduling constraints
  nodeSelector: {}
  
  # -- Tolerations for pod assignment
  tolerations: []
  
  # -- Affinity settings for pod assignment
  affinity: {}
  
  # -- Additional pod annotations
  podAnnotations: {}
  
  # -- Additional pod labels
  podLabels: {}
  
  # -- PostgreSQL resource requirements (optional overrides)
  # Defaults: requests: memory=256Mi, cpu=250m (no limits by default)
  # Example customizations:
  #   resources:
  #     requests:
  #       memory: "512Mi"
  #       cpu: "500m"
  #     limits:
  #       memory: "1Gi"
  #       cpu: "1000m"
  resources: {}
  
  # -- PostgreSQL persistence configuration
  persistence:
    # -- Enable persistent storage
    enabled: true
    
    # -- Size of persistent volume
    size: 8Gi
    
    # -- Access modes for persistent volume
    accessModes:
      - ReadWriteOnce
    
    # -- Additional annotations for PVC
    annotations: {}

# Elasticsearch is used by Temporal for advanced visibility features
elasticsearch:
  # -- Enable Elasticsearch deployment
  # Set to false to disable advanced visibility in Temporal
  enabled: true
  
  # -- Elasticsearch image configuration
  image:
    repository: elasticsearch
    tag: "7.17.10"
    pullPolicy: Always
  
  # -- Pod scheduling constraints
  nodeSelector: {}
  
  # -- Tolerations for pod assignment
  tolerations: []
  
  # -- Affinity settings for pod assignment
  affinity: {}
  
  # -- Additional pod annotations
  podAnnotations: {}
  
  # -- Additional pod labels
  podLabels: {}
  
  # -- Elasticsearch resource requirements (optional overrides)
  # Defaults: requests: memory=1Gi, cpu=500m (no limits by default)
  # Example customizations:
  #   resources:
  #     requests:
  #       memory: "2Gi"
  #       cpu: "1000m"
  #     limits:
  #       memory: "4Gi"
  #       cpu: "2000m"
  resources: {}
